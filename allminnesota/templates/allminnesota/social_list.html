{% extends "allminnesota/base.html" %}
{% block title %}Social Media{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-4">
    <h1 class="h2 mb-0" style="color: var(--am-green-dark);"><i class="fas fa-share-alt me-2"></i>Social Media Posts</h1>
    <div>
        <a href="{% url 'allminnesota:social_calendar' %}" class="btn btn-gold me-2"><i class="fas fa-calendar-alt me-1"></i>Calendar</a>
        <a href="{% url 'allminnesota:social_create' %}" class="btn btn-allminnesota"><i class="fas fa-plus me-1"></i>New Post</a>
    </div>
</div>

<form method="get" class="card allminnesota-card mb-4">
    <div class="card-body">
        <div class="row g-2 align-items-end">
            <div class="col-md-4"><label class="form-label small text-muted">Platform</label>{{ form.platform }}</div>
            <div class="col-md-4"><label class="form-label small text-muted">Status</label>{{ form.status }}</div>
            <div class="col-md-2"><button type="submit" class="btn btn-allminnesota w-100"><i class="fas fa-filter"></i> Filter</button></div>
        </div>
    </div>
</form>

<div class="card allminnesota-card">
    <div class="table-responsive">
        <table class="table table-allminnesota table-hover mb-0">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Platform</th>
                    <th>Status</th>
                    <th>Scheduled</th>
                    <th>Published</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for p in posts %}
                <tr>
                    <td><a href="{% url 'allminnesota:social_detail' p.pk %}">{{ p.title }}</a></td>
                    <td>{{ p.get_platform_display }}</td>
                    <td><span class="badge badge-{{ p.status|lower }}">{{ p.get_status_display }}</span></td>
                    <td>{{ p.scheduled_date|date:"M j, g:i A"|default:"—" }}</td>
                    <td>{{ p.published_date|date:"M j, g:i A"|default:"—" }}</td>
                    <td><a href="{% url 'allminnesota:social_edit' p.pk %}" class="btn btn-sm btn-outline-secondary">Edit</a></td>
                </tr>
                {% empty %}
                <tr><td colspan="6" class="text-center text-muted py-4">No posts found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% if posts.has_other_pages %}
    <div class="card-footer d-flex justify-content-between align-items-center">
        <span class="small text-muted">Page {{ posts.number }} of {{ posts.paginator.num_pages }}</span>
        <ul class="pagination pagination-sm mb-0">
            {% if posts.has_previous %}<li class="page-item"><a class="page-link" href="?page={{ posts.previous_page_number }}&{{ request.GET.urlencode }}">Previous</a></li>{% endif %}
            {% if posts.has_next %}<li class="page-item"><a class="page-link" href="?page={{ posts.next_page_number }}&{{ request.GET.urlencode }}">Next</a></li>{% endif %}
        </ul>
    </div>
    {% endif %}
</div>
{% endblock %}
