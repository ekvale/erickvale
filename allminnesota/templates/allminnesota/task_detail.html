{% extends "allminnesota/base.html" %}
{% block title %}{{ task.title }}{% endblock %}

{% block content %}
<nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'allminnesota:task_list' %}">Tasks</a></li>
        <li class="breadcrumb-item active">{{ task.title }}</li>
    </ol>
</nav>
<div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-4">
    <h1 class="h2 mb-0" style="color: var(--am-green-dark);">{{ task.title }}{% if task.is_overdue %} <span class="badge bg-danger">Overdue</span>{% endif %}</h1>
    <div>
        <a href="{% url 'allminnesota:task_edit' task.pk %}" class="btn btn-allminnesota"><i class="fas fa-edit me-1"></i>Edit</a>
        <a href="{% url 'allminnesota:task_delete' task.pk %}" class="btn btn-outline-danger">Delete</a>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card allminnesota-card mb-4 {% if task.is_overdue %}task-overdue{% endif %}">
            <div class="card-body">
                {% if task.description %}<div class="mb-4">{{ task.description|linebreaks }}</div>{% endif %}
                <dl class="row mb-0">
                    <dt class="col-sm-3">Status</dt><dd class="col-sm-9"><span class="badge bg-secondary">{{ task.get_status_display }}</span></dd>
                    <dt class="col-sm-3">Priority</dt><dd class="col-sm-9"><span class="badge {% if task.priority == 'URGENT' %}bg-danger{% elif task.priority == 'HIGH' %}bg-warning text-dark{% else %}bg-secondary{% endif %}">{{ task.get_priority_display }}</span></dd>
                    <dt class="col-sm-3">Category</dt><dd class="col-sm-9">{{ task.get_category_display }}</dd>
                    <dt class="col-sm-3">Due date</dt><dd class="col-sm-9">{{ task.due_date|date:"M j, Y"|default:"—" }}</dd>
                    <dt class="col-sm-3">Assigned to</dt><dd class="col-sm-9">{{ task.assigned_to.get_full_name|default:task.assigned_to.username|default:"—" }}</dd>
                    <dt class="col-sm-3">Related site</dt><dd class="col-sm-9">{% if task.related_site %}<a href="{% url 'allminnesota:site_detail' task.related_site.pk %}">{{ task.related_site.site_name }}</a>{% else %}—{% endif %}</dd>
                    <dt class="col-sm-3">Created</dt><dd class="col-sm-9">{{ task.created_date|date:"M j, Y" }} by {{ task.created_by.get_full_name|default:task.created_by.username|default:"—" }}</dd>
                    <dt class="col-sm-3">Updated</dt><dd class="col-sm-9">{{ task.updated_date|date:"M j, Y g:i A" }}</dd>
                </dl>
            </div>
        </div>
    </div>
</div>
{% endblock %}
