{% extends 'fraud_detection/base.html' %}
{% load humanize %}

{% block title %}Intervention: {{ intervention.title }}{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h1>{{ intervention.title }}</h1>
        <a href="{% url 'fraud_detection:intervention_list' %}" class="btn btn-secondary">Back to List</a>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5>Intervention Details</h5>
            </div>
            <div class="card-body">
                <table class="table">
                    <tr>
                        <th>Type:</th>
                        <td>{{ intervention.get_intervention_type_display }}</td>
                    </tr>
                    <tr>
                        <th>Status:</th>
                        <td>
                            <span class="badge bg-{% if intervention.status == 'resolved' %}success{% elif intervention.status == 'in_progress' %}info{% elif intervention.status == 'pending' %}warning{% else %}secondary{% endif %}">
                                {{ intervention.get_status_display }}
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <th>Priority:</th>
                        <td>
                            <span class="badge bg-{% if intervention.priority == 'urgent' %}danger{% elif intervention.priority == 'high' %}warning{% elif intervention.priority == 'medium' %}info{% else %}secondary{% endif %}">
                                {{ intervention.get_priority_display }}
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <th>Description:</th>
                        <td>{{ intervention.description|linebreaks }}</td>
                    </tr>
                    <tr>
                        <th>Action Required:</th>
                        <td>{{ intervention.action_required|linebreaks }}</td>
                    </tr>
                    <tr>
                        <th>Assigned To:</th>
                        <td>{{ intervention.assigned_to.username|default:"Unassigned" }}</td>
                    </tr>
                    <tr>
                        <th>Due Date:</th>
                        <td>{{ intervention.due_date|date:"F d, Y H:i"|default:"N/A" }}</td>
                    </tr>
                    {% if intervention.requires_approval %}
                    <tr>
                        <th>Requires Approval:</th>
                        <td>Yes - {{ intervention.approver.username|default:"Not assigned" }}</td>
                    </tr>
                    {% endif %}
                    {% if intervention.resolution_notes %}
                    <tr>
                        <th>Resolution Notes:</th>
                        <td>{{ intervention.resolution_notes|linebreaks }}</td>
                    </tr>
                    {% endif %}
                </table>
            </div>
        </div>
    </div>
</div>

{% if intervention.transaction %}
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5>Related Transaction</h5>
            </div>
            <div class="card-body">
                <p><a href="{% url 'fraud_detection:transaction_detail' intervention.transaction.pk %}">View Transaction: {{ intervention.transaction.transaction_id }}</a></p>
            </div>
        </div>
    </div>
</div>
{% endif %}

{% if intervention.fraud_flag %}
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5>Related Fraud Flag</h5>
            </div>
            <div class="card-body">
                <p><a href="{% url 'fraud_detection:flag_detail' intervention.fraud_flag.pk %}">View Fraud Flag: {{ intervention.fraud_flag.title }}</a></p>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}
